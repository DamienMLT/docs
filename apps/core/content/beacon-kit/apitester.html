<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Beacon Kit Node API Documentation</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        padding-top: 20px;
        padding-bottom: 40px;
      }
      .endpoint-card {
        margin-bottom: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .endpoint-header {
        cursor: pointer;
        padding: 15px;
        border-radius: 8px 8px 0 0;
      }
      .endpoint-body {
        padding: 15px;
        display: none;
      }
      .method-badge {
        font-size: 14px;
        padding: 5px 10px;
        border-radius: 4px;
        margin-right: 10px;
      }
      .get {
        background-color: #61affe;
        color: white;
      }
      .post {
        background-color: #49cc90;
        color: white;
      }
      .delete {
        background-color: #f93e3e;
        color: white;
      }
      .put {
        background-color: #fca130;
        color: white;
      }
      .response-container {
        background-color: #f8f9fa;
        border-radius: 4px;
        padding: 15px;
        margin-top: 15px;
        max-height: 300px;
        overflow-y: auto;
        display: none;
      }
      .nav-pills .nav-link.active {
        background-color: #6c757d;
      }
      pre {
        white-space: pre-wrap;
        word-wrap: break-word;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1 class="text-center mb-4">Beacon Kit Node API Documentation</h1>

      <div class="card mb-4">
        <div class="card-body">
          <div class="mb-3">
            <label for="rpcHost" class="form-label">RPC Host URL</label>
            <input
              type="text"
              class="form-control"
              id="rpcHost"
              value="http://localhost:8545"
            />
          </div>
        </div>
      </div>

      <ul
        class="nav nav-pills mb-4 justify-content-center"
        id="apiTabs"
        role="tablist"
      >
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="beacon-tab"
            data-bs-toggle="pill"
            data-bs-target="#beacon"
            type="button"
            role="tab"
          >
            Beacon API
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="builder-tab"
            data-bs-toggle="pill"
            data-bs-target="#builder"
            type="button"
            role="tab"
          >
            Builder API
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="config-tab"
            data-bs-toggle="pill"
            data-bs-target="#config"
            type="button"
            role="tab"
          >
            Config API
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="debug-tab"
            data-bs-toggle="pill"
            data-bs-target="#debug"
            type="button"
            role="tab"
          >
            Debug API
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="events-tab"
            data-bs-toggle="pill"
            data-bs-target="#events"
            type="button"
            role="tab"
          >
            Events API
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="node-tab"
            data-bs-toggle="pill"
            data-bs-target="#node"
            type="button"
            role="tab"
          >
            Node API
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="proof-tab"
            data-bs-toggle="pill"
            data-bs-target="#proof"
            type="button"
            role="tab"
          >
            Proof API
          </button>
        </li>
      </ul>

      <div class="tab-content" id="apiTabContent">
        <!-- Beacon API -->
        <div
          class="tab-pane fade show active"
          id="beacon"
          role="tabpanel"
          aria-labelledby="beacon-tab"
        >
          <h2 class="mb-3">Beacon API</h2>
          <p>Endpoints for interacting with the beacon chain.</p>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold">/eth/v1/beacon/genesis</span>
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>Retrieves genesis information for the beacon chain.</p>
              <button
                class="btn btn-primary mt-2"
                onclick="executeRequest('GET', '/eth/v1/beacon/genesis')"
              >
                Execute
              </button>
              <div class="response-container">
                <h5>Response</h5>
                <pre id="response-beacon-genesis"></pre>
              </div>
            </div>
          </div>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold"
                  >/eth/v1/beacon/states/{state_id}/validators</span
                >
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>Retrieves validators information from a specific state.</p>
              <div class="mb-3">
                <label for="beacon-state-id" class="form-label">State ID</label>
                <input
                  type="text"
                  class="form-control"
                  id="beacon-state-id"
                  placeholder="head, finalized, justified, or hex state root"
                />
              </div>
              <button
                class="btn btn-primary mt-2"
                onclick="executeRequest('GET', '/eth/v1/beacon/states/' + document.getElementById('beacon-state-id').value + '/validators')"
              >
                Execute
              </button>
              <div class="response-container">
                <h5>Response</h5>
                <pre id="response-beacon-validators"></pre>
              </div>
            </div>
          </div>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold">/eth/v1/beacon/headers</span>
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>Retrieves block headers matching the criteria.</p>
              <div class="mb-3">
                <label for="beacon-slot" class="form-label"
                  >Slot (Optional)</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="beacon-slot"
                  placeholder="Slot number"
                />
              </div>
              <div class="mb-3">
                <label for="beacon-parent-root" class="form-label"
                  >Parent Root (Optional)</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="beacon-parent-root"
                  placeholder="Parent root hash"
                />
              </div>
              <button
                class="btn btn-primary mt-2"
                onclick="executeBeaconHeaders()"
              >
                Execute
              </button>
              <div class="response-container">
                <h5>Response</h5>
                <pre id="response-beacon-headers"></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Builder API -->
        <div
          class="tab-pane fade"
          id="builder"
          role="tabpanel"
          aria-labelledby="builder-tab"
        >
          <h2 class="mb-3">Builder API</h2>
          <p>Endpoints for interacting with block builders.</p>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold">/eth/v1/builder/status</span>
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>Retrieves the status of the builder API.</p>
              <button
                class="btn btn-primary mt-2"
                onclick="executeRequest('GET', '/eth/v1/builder/status')"
              >
                Execute
              </button>
              <div class="response-container">
                <h5>Response</h5>
                <pre id="response-builder-status"></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Config API -->
        <div
          class="tab-pane fade"
          id="config"
          role="tabpanel"
          aria-labelledby="config-tab"
        >
          <h2 class="mb-3">Config API</h2>
          <p>Endpoints for retrieving configuration information.</p>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold">/eth/v1/config/spec</span>
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>
                Retrieves the specification configuration used on this node.
              </p>
              <button
                class="btn btn-primary mt-2"
                onclick="executeRequest('GET', '/eth/v1/config/spec')"
              >
                Execute
              </button>
              <div class="response-container">
                <h5>Response</h5>
                <pre id="response-config-spec"></pre>
              </div>
            </div>
          </div>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold">/eth/v1/config/deposit_contract</span>
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>Retrieves deposit contract address and chain ID.</p>
              <button
                class="btn btn-primary mt-2"
                onclick="executeRequest('GET', '/eth/v1/config/deposit_contract')"
              >
                Execute
              </button>
              <div class="response-container">
                <h5>Response</h5>
                <pre id="response-config-deposit"></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Debug API -->
        <div
          class="tab-pane fade"
          id="debug"
          role="tabpanel"
          aria-labelledby="debug-tab"
        >
          <h2 class="mb-3">Debug API</h2>
          <p>Endpoints for debugging purposes.</p>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold"
                  >/eth/v1/debug/beacon/states/{state_id}</span
                >
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>Retrieves the full beacon state for a given state ID.</p>
              <div class="mb-3">
                <label for="debug-state-id" class="form-label">State ID</label>
                <input
                  type="text"
                  class="form-control"
                  id="debug-state-id"
                  placeholder="head, finalized, justified, or hex state root"
                />
              </div>
              <button
                class="btn btn-primary mt-2"
                onclick="executeRequest('GET', '/eth/v1/debug/beacon/states/' + document.getElementById('debug-state-id').value)"
              >
                Execute
              </button>
              <div class="response-container">
                <h5>Response</h5>
                <pre id="response-debug-state"></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Events API -->
        <div
          class="tab-pane fade"
          id="events"
          role="tabpanel"
          aria-labelledby="events-tab"
        >
          <h2 class="mb-3">Events API</h2>
          <p>Endpoints for subscribing to events.</p>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold">/eth/v1/events</span>
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>Subscribe to beacon node events via Server-Sent Events.</p>
              <div class="mb-3">
                <label class="form-label">Event Topics</label>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    value="head"
                    id="event-head"
                  />
                  <label class="form-check-label" for="event-head">
                    head - New chain head was processed
                  </label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    value="block"
                    id="event-block"
                  />
                  <label class="form-check-label" for="event-block">
                    block - New block was processed
                  </label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    value="finalized_checkpoint"
                    id="event-finalized"
                  />
                  <label class="form-check-label" for="event-finalized">
                    finalized_checkpoint - New finalized checkpoint was
                    processed
                  </label>
                </div>
              </div>
              <button
                class="btn btn-primary mt-2"
                onclick="subscribeToEvents()"
              >
                Subscribe
              </button>
              <button
                class="btn btn-secondary mt-2 ms-2"
                onclick="unsubscribeFromEvents()"
              >
                Unsubscribe
              </button>
              <div class="response-container" style="display: block">
                <h5>Events</h5>
                <pre id="response-events"></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Node API -->
        <div
          class="tab-pane fade"
          id="node"
          role="tabpanel"
          aria-labelledby="node-tab"
        >
          <h2 class="mb-3">Node API</h2>
          <p>Endpoints for retrieving node information.</p>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold">/eth/v1/node/identity</span>
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>Retrieves data about the node's network presence.</p>
              <button
                class="btn btn-primary mt-2"
                onclick="executeRequest('GET', '/eth/v1/node/identity')"
              >
                Execute
              </button>
              <div class="response-container">
                <h5>Response</h5>
                <pre id="response-node-identity"></pre>
              </div>
            </div>
          </div>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold">/eth/v1/node/peers</span>
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>Retrieves data about the node's network peers.</p>
              <div class="mb-3">
                <label for="node-peer-state" class="form-label"
                  >State (Optional)</label
                >
                <select class="form-select" id="node-peer-state">
                  <option value="">All</option>
                  <option value="disconnected">Disconnected</option>
                  <option value="connecting">Connecting</option>
                  <option value="connected">Connected</option>
                  <option value="disconnecting">Disconnecting</option>
                </select>
              </div>
              <button class="btn btn-primary mt-2" onclick="executeNodePeers()">
                Execute
              </button>
              <div class="response-container">
                <h5>Response</h5>
                <pre id="response-node-peers"></pre>
              </div>
            </div>
          </div>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold">/eth/v1/node/version</span>
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>
                Retrieves information about the node's implementation version.
              </p>
              <button
                class="btn btn-primary mt-2"
                onclick="executeRequest('GET', '/eth/v1/node/version')"
              >
                Execute
              </button>
              <div class="response-container">
                <h5>Response</h5>
                <pre id="response-node-version"></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Proof API -->
        <div
          class="tab-pane fade"
          id="proof"
          role="tabpanel"
          aria-labelledby="proof-tab"
        >
          <h2 class="mb-3">Proof API</h2>
          <p>Endpoints for retrieving cryptographic proofs.</p>

          <div class="endpoint-card card">
            <div
              class="endpoint-header bg-light d-flex justify-content-between align-items-center"
              onclick="toggleEndpoint(this)"
            >
              <div>
                <span class="method-badge get">GET</span>
                <span class="fw-bold"
                  >/eth/v1/beacon/states/{state_id}/proof</span
                >
              </div>
              <i class="bi bi-chevron-down"></i>
            </div>
            <div class="endpoint-body">
              <p>Retrieves a proof for a given state and path.</p>
              <div class="mb-3">
                <label for="proof-state-id" class="form-label">State ID</label>
                <input
                  type="text"
                  class="form-control"
                  id="proof-state-id"
                  placeholder="head, finalized, justified, or hex state root"
                />
              </div>
              <div class="mb-3">
                <label for="proof-path" class="form-label">Path</label>
                <input
                  type="text"
                  class="form-control"
                  id="proof-path"
                  placeholder="Path to the state field"
                />
              </div>
              <button
                class="btn btn-primary mt-2"
                onclick="executeProofRequest()"
              >
                Execute
              </button>
              <div class="response-container">
                <h5>Response</h5>
                <pre id="response-proof"></pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      let eventSource = null;

      function toggleEndpoint(element) {
        const body = element.nextElementSibling;
        if (body.style.display === "block") {
          body.style.display = "none";
        } else {
          body.style.display = "block";
        }
      }

      function executeRequest(method, endpoint) {
        const host = document.getElementById("rpcHost").value;
        const url = host + endpoint;
        const responseId =
          "response-" +
          endpoint.split("/").slice(2).join("-").replace(/[{}]/g, "");

        const responseContainer = document.querySelector(
          `pre[id^="${responseId}"]`
        ).parentElement;
        responseContainer.style.display = "block";

        document.querySelector(`pre[id^="${responseId}"]`).textContent =
          "Loading...";

        fetch(url, {
          method: method,
          headers: {
            Accept: "application/json",
          },
        })
          .then((response) => {
            if (!response.ok) {
              throw new Error(`HTTP error! Status: ${response.status}`);
            }
            return response.json();
          })
          .then((data) => {
            document.querySelector(`pre[id^="${responseId}"]`).textContent =
              JSON.stringify(data, null, 2);
          })
          .catch((error) => {
            document.querySelector(
              `pre[id^="${responseId}"]`
            ).textContent = `Error: ${error.message}`;
          });
      }

      function executeBeaconHeaders() {
        const host = document.getElementById("rpcHost").value;
        const slot = document.getElementById("beacon-slot").value;
        const parentRoot = document.getElementById("beacon-parent-root").value;

        let endpoint = "/eth/v1/beacon/headers";
        const params = [];

        if (slot) params.push(`slot=${slot}`);
        if (parentRoot) params.push(`parent_root=${parentRoot}`);

        if (params.length > 0) {
          endpoint += "?" + params.join("&");
        }

        executeRequest("GET", endpoint);
      }

      function executeNodePeers() {
        const host = document.getElementById("rpcHost").value;
        const state = document.getElementById("node-peer-state").value;

        let endpoint = "/eth/v1/node/peers";
        if (state) {
          endpoint += `?state=${state}`;
        }

        executeRequest("GET", endpoint);
      }

      function executeProofRequest() {
        const host = document.getElementById("rpcHost").value;
        const stateId = document.getElementById("proof-state-id").value;
        const path = document.getElementById("proof-path").value;

        let endpoint = `/eth/v1/beacon/states/${stateId}/proof`;
        if (path) {
          endpoint += `?path=${encodeURIComponent(path)}`;
        }

        executeRequest("GET", endpoint);
      }

      function subscribeToEvents() {
        if (eventSource) {
          unsubscribeFromEvents();
        }

        const host = document.getElementById("rpcHost").value;
        const topics = [];

        if (document.getElementById("event-head").checked) topics.push("head");
        if (document.getElementById("event-block").checked)
          topics.push("block");
        if (document.getElementById("event-finalized").checked)
          topics.push("finalized_checkpoint");

        if (topics.length === 0) {
          document.getElementById("response-events").textContent =
            "Please select at least one event topic.";
          return;
        }

        const url = `${host}/eth/v1/events?topics=${topics.join(",")}`;
        document.getElementById(
          "response-events"
        ).textContent = `Connecting to ${url}...`;

        try {
          eventSource = new EventSource(url);

          eventSource.onopen = function () {
            document.getElementById("response-events").textContent =
              "Connected to event stream. Waiting for events...\n";
          };

          eventSource.onmessage = function (event) {
            const currentText =
              document.getElementById("response-events").textContent;
            document.getElementById("response-events").textContent =
              currentText + event.data + "\n";
          };

          eventSource.onerror = function (error) {
            document.getElementById("response-events").textContent +=
              "Error: Connection failed or server closed connection.\n";
            eventSource.close();
            eventSource = null;
          };

          topics.forEach((topic) => {
            eventSource.addEventListener(topic, function (event) {
              const currentText =
                document.getElementById("response-events").textContent;
              document.getElementById("response-events").textContent =
                currentText + `[${topic}] ${event.data}\n`;
            });
          });
        } catch (error) {
          document.getElementById(
            "response-events"
          ).textContent = `Error: ${error.message}`;
        }
      }

      function unsubscribeFromEvents() {
        if (eventSource) {
          eventSource.close();
          eventSource = null;
          document.getElementById("response-events").textContent +=
            "Disconnected from event stream.\n";
        }
      }

      // Initialize all endpoint bodies as hidden
      document.addEventListener("DOMContentLoaded", function () {
        const endpointHeaders = document.querySelectorAll(".endpoint-header");
        endpointHeaders.forEach((header) => {
          header.nextElementSibling.style.display = "none";
        });
      });
    </script>
  </body>
</html>
